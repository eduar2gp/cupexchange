<mat-sidenav-container fullscreen>
  <!-- Left sidenav -->
  <mat-sidenav #sidenav mode="over" opened="false" position="start">
    <div class="menu-header">
      <h3>Menu</h3>
    </div>
    <mat-nav-list>
      @if (authService.isAuthenticated()) {
      <a mat-list-item routerLink="/add-order" (click)="sidenav.close()">
        <mat-icon matListItemIcon>add_circle</mat-icon>
        <span matListItemTitle>Crear Orden</span>
      </a>
      <a mat-list-item routerLink="/wallet">
        <mat-icon matListItemIcon>account_balance_wallet</mat-icon>
        <span matListItemTitle>Mi Billetera</span>
      </a>
      <a mat-list-item routerLink="/orders">
        <mat-icon matListItemIcon>list_alt</mat-icon>
        <span matListItemTitle>Mis Ordenes</span>
      </a>
      <a mat-list-item (click)="handleLogout()">
        <mat-icon matListItemIcon>logout</mat-icon>
        <span matListItemTitle>Logout</span>
      </a>
      <mat-slide-toggle [checked]="isDark" (change)="toggleTheme()">
        Dark Mode
      </mat-slide-toggle>
      } @else {
      <a mat-list-item routerLink="/login" (click)="sidenav.close()">
        <mat-icon matListItemIcon>login</mat-icon>
        <span matListItemTitle>Login</span>
      </a>
      }
    </mat-nav-list>
  </mat-sidenav>
  <!-- Main content -->
  <mat-sidenav-content class="sidenav-content">
    @if (authService.isAuthenticated()) {
    <!-- Top toolbar -->
    <mat-toolbar class="app-toolbar fixed-top">
      <button mat-icon-button (click)="sidenav.toggle()">
        <mat-icon>menu</mat-icon>
      </button>

      <mat-form-field appearance="outline" class="pair-selector">
        <mat-label>Trade Pair</mat-label>
        <mat-select [ngModel]="selectedPair"
                    (ngModelChange)="onPairSelect($event)"
                    [ngModelOptions]="{standalone: true}">
          @for (pair of availablePairs; track pair) {
          <mat-option [value]="pair">{{ pair.value }}</mat-option>
          }
        </mat-select>
        <mat-icon matPrefix>paid</mat-icon>
      </mat-form-field>

      <span class="toolbar-title">{{ title() }}</span>
      <span class="spacer"></span>

      <button mat-icon-button>
        <mat-icon [matBadge]="orderCount$ | async" badgeColor="accent">shopping_cart</mat-icon>
      </button>
    </mat-toolbar>
    }
    <!-- Page content -->
    <main class="main-content">
      <router-outlet></router-outlet>
    </main>
    <!-- Bottom navigation (only when authenticated) -->
    @if (authService.isAuthenticated()) {
    <mat-toolbar color="primary" class="bottom-nav fixed-bottom">
      <a mat-button routerLink="/dashboard" routerLinkActive="active" class="nav-item">
        <mat-icon>show_chart</mat-icon>
        <div class="nav-label">Principal</div>
      </a>
      <a mat-button routerLink="/wallet" routerLinkActive="active" class="nav-item">
        <mat-icon>wallet</mat-icon>
        <div class="nav-label">Billetera</div>
      </a>
      <a mat-button routerLink="/orders" routerLinkActive="active" class="nav-item">
        <mat-icon>poll</mat-icon>
        <div class="nav-label">Ordenes</div>
      </a>
      <a mat-button routerLink="/transactions" routerLinkActive="active" class="nav-item">
        <mat-icon>compare_arrows</mat-icon>
        <div class="nav-label">Transacciones</div>
      </a>
    </mat-toolbar>
    }
  </mat-sidenav-content>
</mat-sidenav-container>
