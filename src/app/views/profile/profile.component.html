<div class="profile-container">
  <h2>My Profile</h2>

  <div class="user-info-section">
    <h3>Account Details</h3>
    <p><strong>Username:</strong> {{ loggedInUser?.username }}</p>
    <p><strong>Email:</strong> {{ loggedInUser?.email }}</p>
  </div>

  <form [formGroup]="profileForm">
    <h3>Personal Information</h3>

    <div class="form-grid">
      <mat-form-field appearance="outline">
        <mat-label>First Name</mat-label>
        <mat-icon matIconPrefix>person</mat-icon> <input matInput formControlName="firstName">
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Middle Name</mat-label>
        <mat-icon matIconPrefix>badge</mat-icon>
        <input matInput formControlName="middleName">
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Last Name</mat-label>
        <mat-icon matIconPrefix>groups</mat-icon>
        <input matInput formControlName="lastName">
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Phone</mat-label>
        <mat-icon matIconPrefix>phone</mat-icon>
        <input matInput formControlName="phone">
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Address</mat-label>
        <mat-icon matIconPrefix>home</mat-icon>
        <input matInput formControlName="address">
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Province</mat-label>
        <mat-icon matIconPrefix>map</mat-icon>
        <mat-select formControlName="provinceId">
          <mat-option *ngFor="let prov of provinces" [value]="prov.id">
            {{ prov.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Municipality</mat-label>
        <mat-icon matIconPrefix>location_city</mat-icon>
        <mat-select formControlName="municipalityId">
          <mat-option *ngFor="let muni of filteredMunicipalities" [value]="muni.id">
            {{ muni.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </form>

  <div class="button-container">
    <button mat-raised-button *ngIf="!isEditing" (click)="toggleEdit()" color="primary">
      Edit Profile
    </button>

    <ng-container *ngIf="isEditing">
      <button mat-raised-button color="accent" (click)="saveProfile()" [disabled]="profileForm.invalid">
        Save Changes
      </button>
      <button mat-button (click)="toggleEdit()">Cancel</button>
    </ng-container>
  </div>
</div>
