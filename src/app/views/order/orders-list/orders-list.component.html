<!-- Loading state -->
@if (loading()) {
  <div class="container">
    <mat-progress-spinner mode="indeterminate" diameter="50"></mat-progress-spinner>
    <p>Loading your orders...</p>
  </div>
}

<!-- Error state -->
@if (error()) {
  <div class="container error">
    <p>{{ error() }}</p>
    <button mat-raised-button color="primary" (click)="refresh()">Retry</button>
  </div>
}

<!-- Empty state -->
@if (!loading() && !error() && displayedOrders().length === 0) {
  <div class="container empty">
    <mat-icon>inventory_2</mat-icon>
    <p>No orders found.</p>
  </div>
}

<!-- Orders list -->
@if (!loading() && !error() && displayedOrders().length > 0) {
  <mat-list class="orders-list">
    @for (order of displayedOrders(); track order) {
    <mat-list-item class="order-item">
      <!-- Header Row -->
      <div class="order-header" matLine>
        <!-- Left: Base Currency -->
        <strong class="base-currency">{{ order.pair.baseCurrency }}</strong>

        <!-- Center: BUY/SELL Badge -->
        <span class="side-wrapper">
          <span class="side" [class.buy]="order.side === 'BUY'" [class.sell]="order.side === 'SELL'">
            {{ order.side }}
          </span>
        </span>

        <!-- Right: Status + Cancel Button -->
        <div class="status-actions">
          <span class="status">{{ order.status }}</span>

          <!-- Cancel button: shown only for ACTIVE or PARTLY_FILLED -->
          @if (order.status === 'ACTIVE' || order.status === 'PARTLY_FILLED') {
          <button mat-icon-button
                  color="warn"
                  (click)="cancelOrder(order)"
                  matTooltip="Cancel Order"
                  class="cancel-button">
            <mat-icon>close</mat-icon>
          </button>
          }
        </div>
      </div>

      <!-- Details Row -->
      <div matLine class="order-details">
        <span>Price: {{ order.price | number:'1.4-8' }} {{ order.reservedCurrency || order.pair.quoteCurrency }}</span>
        <span>| Volume: {{ order.volumeFilled }} / {{ order.volumeTotal }}</span>
      </div>

      <!-- Date Row -->
      <div matLine class="order-date">
        <span>{{ order.createdAt | date:'medium' }}</span>
        @if (order.fullyFilled) {
        <mat-icon class="filled-icon">check_circle</mat-icon>
        }
      </div>
    </mat-list-item>
    }
  </mat-list>
}
