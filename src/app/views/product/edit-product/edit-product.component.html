<div class="edit-container">
  @if (providerData$ | async; as provider) {
  <div class="provider-banner">
    <img [src]="provider.profileImageUrl" class="provider-avatar" alt="provider branding" />
    <div class="banner-text">
      <span class="mat-caption">Managing Catalog for</span>
      <h2>{{ provider.name }}</h2>
    </div>
  </div>
  }

  @if (productData$ | async; as product) {
  <mat-card class="product-card" appearance="outlined">
    <mat-card-header>
      <mat-icon mat-card-avatar color="primary">inventory_2</mat-icon>
      <mat-card-title>Edit Product Information</mat-card-title>
      <mat-card-subtitle>Update pricing, images, and description</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <form #productForm="ngForm" (ngSubmit)="saveProduct(product)" class="product-form">

        <div class="layout-grid">
          <div class="image-section">
            <div class="image-preview-wrapper" (click)="fileInput.click()">
              <img [src]="product.productImageUrl" class="main-preview" alt="product preview" />
              <div class="overlay">
                <mat-icon>cloud_upload</mat-icon>
                <span>Change Image</span>
              </div>
            </div>
            <input type="file" hidden (change)="onFileSelected($event)" accept="image/*" #fileInput>
            <p class="image-hint">Click image to upload new version</p>
          </div>

          <div class="details-section">
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Product Name</mat-label>
              <input matInput name="name" [(ngModel)]="product.name" required>
              <mat-icon matSuffix>label</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Price</mat-label>
              <input matInput name="price" [(ngModel)]="product.price" type="number" placeholder="0.00">
              <span matPrefix>$&nbsp;</span>
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Description</mat-label>
              <textarea matInput name="description" [(ngModel)]="product.description" rows="4"></textarea>
            </mat-form-field>
          </div>
        </div>

        <mat-divider></mat-divider>

        <div class="form-actions">
          <button mat-button type="button" color="warn">Discard Changes</button>
          <button mat-flat-button color="primary" type="submit" [disabled]="productForm.invalid">
            <mat-icon>check</mat-icon>
            Save Product
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
  }
</div>
